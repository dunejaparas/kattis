<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta content="Apache Forrest" name="Generator">
<meta name="Forrest-version" content="0.8">
<meta name="Forrest-skin-name" content="pelt">
<title>Step 4: Derby Network Server</title>
<link type="text/css" href="../../skin/basic.css" rel="stylesheet">
<link media="screen" type="text/css" href="../../skin/screen.css" rel="stylesheet">
<link media="print" type="text/css" href="../../skin/print.css" rel="stylesheet">
<link type="text/css" href="../../skin/profile.css" rel="stylesheet">
<script src="../../skin/getBlank.js" language="javascript" type="text/javascript"></script><script src="../../skin/getMenu.js" language="javascript" type="text/javascript"></script><script src="../../skin/fontsize.js" language="javascript" type="text/javascript"></script>
<link rel="shortcut icon" href="../../">
</head>
<body onload="init()">
<script type="text/javascript">ndeSetTextSize();</script>
<div id="top">
<!--+
    |breadtrail
    +-->
<div class="breadtrail">
<a href="http://www.apache.org/">apache</a> &gt; <a href="http://db.apache.org/">db</a><script src="../../skin/breadcrumbs.js" language="JavaScript" type="text/javascript"></script>
</div>
<!--+
    |header
    +-->
<div class="header">
<!--+
    |start group logo
    +-->
<div class="grouplogo">
<a href="http://db.apache.org/derby"><img class="logoImage" alt="Apache Derby" src="../../images/derby-logo-web.png" title="Derby is a zero-admin Java RDBMS"></a>
</div>
<!--+
    |end group logo
    +-->
<!--+
    |start Project Logo
    +-->
<div class="projectlogoA1">
<a href="http://db.apache.org"><img class="logoImage" alt="Apache DB Project" src="../../images/db-logo-white.png" title="Apache DB creates and maintains database solutions."></a>
</div>
<!--+
    |end Project Logo
    +-->
<!--+
    |start Tabs
    +-->
<ul id="tabs">
<li>
<a class="unselected" href="../../index.html">Home</a>
</li>
<li>
<a class="unselected" href="../../quick_start.html">Quick Start</a>
</li>
<li>
<a class="unselected" href="../../derby_downloads.html">Download</a>
</li>
<li>
<a class="unselected" href="../../derby_comm.html">Community</a>
</li>
<li>
<a class="unselected" href="../../manuals/index.html">Documentation</a>
</li>
<li class="current">
<a class="selected" href="../../blogs/index.html">Resources</a>
</li>
</ul>
<!--+
    |end Tabs
    +-->
</div>
</div>
<div id="main">
<div id="publishedStrip">
<!--+
    |start Subtabs
    +-->
<div id="level2tabs"></div>
<!--+
    |end Endtabs
    +-->
<script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
</div>
<!--+
    |breadtrail
    +-->
<div class="breadtrail">

             &nbsp;
           </div>
<!--+
    |start Menu, mainarea
    +-->
<!--+
    |start Menu
    +-->
<div id="menu">
<div onclick="SwitchMenu('menu_1.1', '../../skin/')" id="menu_1.1Title" class="menutitle">Blogs and Articles About Derby</div>
<div id="menu_1.1" class="menuitemgroup">
<div class="menuitem">
<a href="../../blogs/index.html">Overview</a>
</div>
<div class="menuitem">
<a href="../../blogs/index.html#blogs">Blogs</a>
</div>
<div onclick="SwitchMenu('menu_1.1.3', '../../skin/')" id="menu_1.1.3Title" class="menutitle">Articles</div>
<div id="menu_1.1.3" class="menuitemgroup">
<div onclick="SwitchMenu('menu_1.1.3.1', '../../skin/')" id="menu_1.1.3.1Title" class="menutitle">Tutorials, Tips and Tuning</div>
<div id="menu_1.1.3.1" class="menuitemgroup">
<div class="menuitem">
<a href="../../blogs/index.html#getstarted">Getting Started</a>
</div>
<div class="menuitem">
<a href="../../blogs/index.html#features">Features, Hints and Tips</a>
</div>
<div class="menuitem">
<a href="../../blogs/index.html#security">Security</a>
</div>
<div class="menuitem">
<a href="../../blogs/index.html#performance">Performance and Tuning</a>
</div>
</div>
<div onclick="SwitchMenu('menu_1.1.3.2', '../../skin/')" id="menu_1.1.3.2Title" class="menutitle">Tools and Migration</div>
<div id="menu_1.1.3.2" class="menuitemgroup">
<div class="menuitem">
<a href="../../blogs/index.html#tools">Tools</a>
</div>
<div class="menuitem">
<a href="../../blogs/index.html#migration">Migration</a>
</div>
</div>
<div onclick="SwitchMenu('menu_1.1.3.3', '../../skin/')" id="menu_1.1.3.3Title" class="menutitle">Applications</div>
<div id="menu_1.1.3.3" class="menuitemgroup">
<div class="menuitem">
<a href="../../blogs/index.html#client">Client</a>
</div>
<div class="menuitem">
<a href="../../blogs/index.html#middletier">Middle Tier</a>
</div>
<div class="menuitem">
<a href="../../blogs/index.html#persistence">Persistence</a>
</div>
<div class="menuitem">
<a href="../../blogs/index.html#scalability">Scalability and Failover</a>
</div>
</div>
</div>
</div>
<div onclick="SwitchMenu('menu_1.2', '../../skin/')" id="menu_1.2Title" class="menutitle">Integration With Other Products</div>
<div id="menu_1.2" class="menuitemgroup">
<div class="menuitem">
<a href="../../integrate/index.html">Overview</a>
</div>
<div class="menuitem">
<a href="../../integrate/index.html#uses">What works with Derby?</a>
</div>
<div class="menuitem">
<a href="../../integrate/index.html#products">Product Writeups</a>
</div>
</div>
<div onclick="SwitchMenu('menu_1.3', '../../skin/')" id="menu_1.3Title" class="menutitle">Eclipse Plug-ins</div>
<div id="menu_1.3" class="menuitemgroup">
<div class="menuitem">
<a href="../../integrate/derby_plugin_info.html">Info</a>
</div>
</div>
<div onclick="SwitchMenu('menu_selected_1.4', '../../skin/')" id="menu_selected_1.4Title" class="menutitle" style="background-image: url('../../skin/images/chapter_open.gif');">Papers and Presentations</div>
<div id="menu_selected_1.4" class="selectedmenuitemgroup" style="display: block;">
<div class="menuitem">
<a href="../../papers/index.html">Overview</a>
</div>
<div onclick="SwitchMenu('menu_1.4.2', '../../skin/')" id="menu_1.4.2Title" class="menutitle">Derby Engine</div>
<div id="menu_1.4.2" class="menuitemgroup">
<div onclick="SwitchMenu('menu_1.4.2.1', '../../skin/')" id="menu_1.4.2.1Title" class="menutitle">Javadoc</div>
<div id="menu_1.4.2.1" class="menuitemgroup">
<div class="menuitem">
<a href="http://db.apache.org/derby/javadoc/engine">Engine</a>
</div>
<div class="menuitem">
<a href="http://db.apache.org/derby/javadoc/language">Language</a>
</div>
<div class="menuitem">
<a href="http://db.apache.org/derby/javadoc/tools">Tools</a>
</div>
<div class="menuitem">
<a href="http://db.apache.org/derby/javadoc/publishedapi">API</a>
</div>
</div>
<div class="menuitem">
<a href="../../papers/derby_arch.html">Architecture</a>
</div>
<div class="menuitem">
<a href="../../papers/btree_package.html">BTree</a>
</div>
<div class="menuitem">
<a href="../../papers/pageformats.html">Disk Page Format</a>
</div>
<div class="menuitem">
<a href="../../papers/derby_htw.html">How Things Work</a>
</div>
<div class="menuitem">
<a href="../../papers/Intersect-design.html">Intersect &amp; Except</a>
</div>
<div class="menuitem">
<a href="../../papers/JDBCImplementation.html">JDBC</a>
</div>
<div class="menuitem">
<a href="../../papers/logformats.html">Log Format</a>
</div>
<div class="menuitem">
<a href="../../papers/recovery.html">Logging &amp; Recovery</a>
</div>
<div class="menuitem">
<a href="../../papers/optimizer.html">Optimizer</a>
</div>
<div class="menuitem">
<a href="http://db.apache.org/derby/javadoc/engine/org/apache/derby/iapi/types/package-summary.html#package_description">Type System</a>
</div>
<div class="menuitem">
<a href="../../papers/versionupgrade.html">Versioning</a>
</div>
</div>
<div onclick="SwitchMenu('menu_1.4.3', '../../skin/')" id="menu_1.4.3Title" class="menutitle">Derby Network Client</div>
<div id="menu_1.4.3" class="menuitemgroup">
<div class="menuitem">
<a href="../../papers/DerbyClientSpec.html">Functional Spec</a>
</div>
</div>
<div onclick="SwitchMenu('menu_selected_1.4.4', '../../skin/')" id="menu_selected_1.4.4Title" class="menutitle" style="background-image: url('../../skin/images/chapter_open.gif');">Derby Tutorial</div>
<div id="menu_selected_1.4.4" class="selectedmenuitemgroup" style="display: block;">
<div class="menuitem">
<a href="../../papers/DerbyTut/index.html">Overview</a>
</div>
<div class="menuitem">
<a href="../../papers/DerbyTut/install_software.html">Step 1: Install Software</a>
</div>
<div class="menuitem">
<a href="../../papers/DerbyTut/ij_intro.html">Step 2: ij Basics</a>
</div>
<div class="menuitem">
<a href="../../papers/DerbyTut/embedded_intro.html">Step 3: Embedded Derby</a>
</div>
<div class="menupage">
<div class="menupagetitle">Step 4: Derby Network Server</div>
</div>
</div>
<div onclick="SwitchMenu('menu_1.4.5', '../../skin/')" id="menu_1.4.5Title" class="menutitle">Presentations</div>
<div id="menu_1.4.5" class="menuitemgroup">
<div class="menuitem">
<a href="../../papers/ApacheCon.html">ApacheCon</a>
</div>
<div class="menuitem">
<a href="../../papers/MiscPresentations.html#Victorian+Java+User+Group">Victorian JUG 2008</a>
</div>
<div class="menuitem">
<a href="../../papers/MiscPresentations.html#OSCON+2005">OSCON 2005</a>
</div>
<div class="menuitem">
<a href="../../papers/MiscPresentations.html#Colorado+Software+Summit+2004">Colorado 2004</a>
</div>
</div>
</div>
<div onclick="SwitchMenu('menu_1.5', '../../skin/')" id="menu_1.5Title" class="menutitle">The Apache Software Foundation</div>
<div id="menu_1.5" class="menuitemgroup">
<div class="menuitem">
<a href="http://www.apache.org/licenses/">License</a>
</div>
<div class="menuitem">
<a href="http://www.apache.org/foundation/sponsorship.html">Donate</a>
</div>
<div class="menuitem">
<a href="http://www.apache.org/foundation/thanks.html">Thanks</a>
</div>
<div class="menuitem">
<a href="http://www.apache.org/security/">Security</a>
</div>
<div class="menuitem">
<a href="http://www.apache.org/">ASF Home</a>
</div>
</div>
<!--+
    |start Search
    +-->
<div class="searchbox">
<hr>
<form action="http://www.google.com/search" method="get">
<input value="db.apache.org" name="sitesearch" type="hidden"><input onFocus="getBlank (this, 'Search the site with google');" size="18" name="q" id="query" type="text" value="Search the site with google">&nbsp; 
                  <input name="Search" value="Search" type="submit">
</form>
</div>
<!--+
    |end search
    +-->
<div id="credit"></div>
<div id="roundbottom">
<img style="display: none" class="corner" height="15" width="15" alt="" src="../../skin/images/rc-b-l-15-1body-2menu-3menu.png"></div>
<!--+
  |alternative credits
  +-->
<div id="credit2"></div>
</div>
<!--+
    |end Menu
    +-->
<!--+
    |start content
    +-->
<div id="content">
<div class="trail">Font size: 
	          &nbsp;<input value="Reset" class="resetfont" title="Reset text" onclick="ndeSetTextSize('reset'); return false;" type="button">      
	          &nbsp;<input value="-a" class="smallerfont" title="Shrink text" onclick="ndeSetTextSize('decr'); return false;" type="button">
	          &nbsp;<input value="+a" class="biggerfont" title="Enlarge text" onclick="ndeSetTextSize('incr'); return false;" type="button">
</div>
<h1>Step 4: Derby Network Server</h1>
<div id="minitoc-area">
<ul class="minitoc">
<li>
<a href="#ns_intro">Introduction</a>
</li>
<li>
<a href="#ns">Derby Network Server</a>
<ul class="minitoc">
<li>
<a href="#ns_config_env">Configure environment</a>
</li>
<li>
<a href="#start_ns">Start Network Server</a>
</li>
<li>
<a href="#ns_easier_way">An easier way: derbyrun.jar</a>
</li>
</ul>
</li>
<li>
<a href="#ns_sample">Sample Application</a>
<ul class="minitoc">
<li>
<a href="#configure_ns_client">Configure environment to use Derby Network Client JDBC driver</a>
</li>
<li>
<a href="#ij_ns_client">Test network server connection with ij</a>
</li>
<li>
<a href="#copy_ns_client">Copy sample application</a>
</li>
<li>
<a href="#ns_lookat_code">A quick look at the code</a>
<ul class="minitoc">
<li>
<a href="#jdbc_ns_client">Load the Client JDBC Driver</a>
</li>
<li>
<a href="#url_ns_client">Get a Network Server Connection</a>
</li>
<li>
<a href="#ns_client_noshutdown">Don't shut Derby down</a>
</li>
</ul>
</li>
<li>
<a href="#compile_ns_client">Compile Sample Application</a>
</li>
<li>
<a href="#run_ns_client">Run Sample Application</a>
</li>
</ul>
</li>
<li>
<a href="#stop_ns">Stop Network Server</a>
</li>
<li>
<a href="#ns_next_steps">Next Steps</a>
<ul class="minitoc">
<li>
<a href="#Network+Server+Options">Network Server Options</a>
</li>
<li>
<a href="#Embedded+Server">Embedded Server</a>
</li>
</ul>
</li>
</ul>
</div> 


<a name="N1000D"></a><a name="ns_intro"></a>
<h2 class="boxed">Introduction</h2>
<div class="section">
<p>
As explained in
the "<a href="embedded_intro.html">Embedded Derby</a>" section,
an application can embed Derby, 
which means that the Derby engine runs in the same JVM as the application.
</p>
<p>
However, an application can also access a Derby database using the more
familiar client/server mode.
This is achieved <em>via</em> a framework that embeds Derby and handles
database requests from applications, including applications running in
different JVMs on the same machine or on remote machines.
The Derby Network Server is such a framework. It embeds Derby 
and manages requests from network clients,
as depicted in Figure 2.
</p>
<p>

<strong>Figure 2: Derby Network Server Architecture</strong>

</p>
<p>

<img alt="Figure 2: Derby Network Server Architecture" src="network_server.png">
</p>
<p>
This section shows how to start the Derby Network Server,
configure your environment to use the Derby Network Client JDBC driver,
and compile and run a simple Java application that uses the network server.
The information presented here is minimal, just enough to help get new 
users started.
For complete information, see part one of the
<a href="http://db.apache.org/derby/manuals">Derby Server and 
Administration Guide</a>.
</p>
</div>


<a name="N10035"></a><a name="ns"></a>
<h2 class="boxed">Derby Network Server</h2>
<div class="section">
<p>
   First set the
   <a href="install_software.html#set_derby_install">DERBY_INSTALL</a>
   environment variable.
</p>
<a name="N10042"></a><a name="ns_config_env"></a>
<h3 class="boxed">Configure environment</h3>
<p>To start or stop the Network Server,
      set your <span class="codefrag">CLASSPATH</span> to include the jar files listed below:</p>
<ul>
     
<li> 
<span class="codefrag">derbynet.jar</span>: contains the code for
   the Derby Network Server and a reference to the engine jar file (derby.jar)
     </li>
	 
<li>
<span class="codefrag">derbytools.jar</span>: contains Derby tools
     </li>

</ul>
<p>
   You can set your <span class="codefrag">CLASSPATH</span> explicitly with the command
   shown below:
</p>
<p class="code-block">Windows:
C:\&gt; set CLASSPATH=%DERBY_INSTALL%\lib\derbytools.jar;%DERBY_INSTALL%\lib\derbynet.jar;.
</p>
<p class="code-block">UNIX:
$ export CLASSPATH=$DERBY_INSTALL/lib/derbytools.jar:$DERBY_INSTALL\lib\derbynet.jar:.
</p>
<p>
   You can also use the script that the Derby software distribution provides 
   to set <span class="codefrag">CLASSPATH</span>.
   Change directory to the
   <span class="codefrag">DERBY_INSTALL/bin</span> directory,
    then execute
   <span class="codefrag">setNetworkServerCP.bat</span> (Windows) or
     <span class="codefrag">setNetworkServerCP.ksh</span> (UNIX), as shown below:
   </p>
<p class="code-block">Windows:
C:\&gt; cd %DERBY_INSTALL%\bin
C:\Apache\db-derby-10.4.1.3-bin\bin&gt; setNetworkServerCP.bat
</p>
<p class="code-block">UNIX:
$ cd $DERBY_INSTALL/bin
$ . setNetworkServerCP.ksh
</p>
<a name="N10082"></a><a name="start_ns"></a>
<h3 class="boxed">Start Network Server</h3>
<p>
Start the Network server by executing the
<span class="codefrag">startNetworkServer.bat</span> (Windows) or
<span class="codefrag">startNetworkServer.ksh</span> (UNIX) script.
This will start the Network Server up on port 1527 and echo a startup
message:
</p>
<p class="code-block">Windows:
C:\Apache\db-derby-10.4.1.3-bin\bin&gt; startNetworkServer.bat
Security manager installed using the Basic server security policy.
Apache Derby Network Server - 10.4.1.3 - (648739) started and ready to 
	accept connections on port 1527 at 2008-04-28 17:13:13.921 GMT
</p>
<p class="code-block">UNIX:
$ startNetworkServer.ksh
Security manager installed using the Basic server security policy.
Apache Derby Network Server - 10.4.1.3 - (648739) started and ready to 
	accept connections on port 1527 at 2008-04-30 09:35:55.871 GMT 
</p>
<p>
Messages will continue to be output to this window as the Network Server
processes connection requests.
</p>
<p>
The Network Server starts Derby, so you'll find the <span class="codefrag">derby.log</span>
error log in the directory where you start the Network Server.
</p>
<a name="N100A3"></a><a name="ns_easier_way"></a>
<h3 class="boxed">An easier way: derbyrun.jar</h3>
<p>
Furthermore, it is much easier to start Network Server now than before,
due to various jar file improvements. With the latest releases, the
entire sections "Configure environment" and "Start Network Server" could actually
be replaced with just one command line:
</p>
<p class="code-block">Windows:
C:\Apache\db-derby-10.4.1.3-bin\lib&gt; java -jar derbyrun.jar server start
Security manager installed using the Basic server security policy.
Apache Derby Network Server - 10.4.1.3 - (648739) started and ready to 
	accept connections on port 1527 at 2008-04-28 17:13:13.921 GMT
</p>
<p class="code-block">UNIX:
$ java -jar derbyrun.jar server start
Security manager installed using the Basic server security policy.
Apache Derby Network Server - 10.4.1.3 - (648739) started and ready to 
	accept connections on port 1527 at 2008-04-30 09:35:55.871 GMT 
</p>
</div>


<a name="N100B6"></a><a name="ns_sample"></a>
<h2 class="boxed">Sample Application</h2>
<div class="section">
<p>
   Open a new window and set the
   <a href="install_software.html#set_derby_install">DERBY_INSTALL</a>
   environment variable.
</p>
<a name="N100C3"></a><a name="configure_ns_client"></a>
<h3 class="boxed">Configure environment to use Derby Network Client JDBC driver</h3>
<p>To use the Derby Network Client JDBC driver,
      set your <span class="codefrag">CLASSPATH</span> to include the jar files listed below:</p>
<ul>
     
<li> 
<span class="codefrag">derbyclient.jar</span>: contains the JDBC driver
     </li>
     
<li> 
<span class="codefrag">derbytools.jar</span>:
           optional, provides the <span class="codefrag">ij</span> tool</li>

</ul>
<p>
   You can set your <span class="codefrag">CLASSPATH</span> explicitly with the command
   shown below:
</p>
<p class="code-block">Windows:
C:\&gt; set CLASSPATH=%DERBY_INSTALL%\lib\derbyclient.jar;%DERBY_INSTALL%\lib\derbytools.jar;.
</p>
<p class="code-block">UNIX:
$ export CLASSPATH=$DERBY_INSTALL/lib/derbyclient.jar:$DERBY_INSTALL/lib/derbytools.jar:.
</p>
<p>
   You can also use the script that the Derby software distribution provides 
   to set <span class="codefrag">CLASSPATH</span>.
   Change directory to the
   <span class="codefrag">DERBY_INSTALL/bin</span> directory,
    then execute
    the <span class="codefrag">setNetworkClientCP.bat</span> (Windows) or
     <span class="codefrag">setNetworkClientCP.ksh</span> (UNIX) script as shown below:
    </p>
<p class="code-block">Windows:
C:\Apache\db-derby-10.4.1.3-bin\bin&gt; setNetworkClientCP.bat
</p>
<p class="code-block">UNIX:
$ . setNetworkClientCP.ksh
</p>
<a name="N10107"></a><a name="ij_ns_client"></a>
<h3 class="boxed">Test network server connection with ij</h3>
<p>
   An <strong>embedded</strong> 
   connection URL that creates and connects to a database
   looks like this:
   </p>
<p class="code-block">java org.apache.derby.tools.ij
ij&gt; connect 'jdbc:derby:MyDbTest;create=true';</p>
<p>
   A Derby Network Client connection URL is very close; just add
   <span class="codefrag">//localhost:1527/</span> before the database name:
   </p>
<p class="code-block">java org.apache.derby.tools.ij
ij&gt; connect 'jdbc:derby://localhost:1527/MyDbTest;create=true';</p>
<p>
   What is the physical location of the newly created database?
   </p>
<p>
   If you use the embedded driver, by default the database is created
   in the same directory in which <span class="codefrag">ij</span> was started up.
   If you use the Derby Network Client JDBC driver, 
   by default the database is created
   in the directory where the Network Server was started up; 
   in other words, in
   <span class="codefrag">DERBY_INSTALL/bin</span>.
   </p>
<p>
   Derby provides many ways to specify the actual location.
   For example, the connection URL below specifies a full path for the database
   location:
   </p>
<p class="code-block">java org.apache.derby.tools.ij
ij&gt; connect 'jdbc:derby://localhost:1527//home/bill/DerbyDb/MyDbTest;create=true';</p>
<p>
   The <em>Developer's Guide</em> provides information
   about where Derby looks for databases:
   </p>
<ul>
      
<li>
<a href="http://db.apache.org/derby/docs/dev/devguide/cdevdvlp34964.html">Connecting to databases</a>
</li>
      
<li> 
<a href="http://db.apache.org/derby/docs/dev/devguide/cdevdvlp13018.html">Defining the system directory</a>
</li>
   
</ul>
<a name="N10149"></a><a name="copy_ns_client"></a>
<h3 class="boxed">Copy sample application</h3>
<p>
   This section uses the same sample application that the 
   "<a href="embedded_intro.html">Embedded Derby</a>" section uses.
   </p>
<p>
   By default this application runs in embedded mode.
   If you pass it the <span class="codefrag">derbyclient</span> argument at run time, 
   then it will
   create and connect to the database using the Derby Network Client JDBC
   driver instead.
   </p>
<a name="N1015D"></a><a name="ns_lookat_code"></a>
<h3 class="boxed">A quick look at the code</h3>
<p>
   The <span class="codefrag">SimpleApp.java</span> application spends most of its time
   creating a table, inserting data into that table, and selecting the
   data back, demonstrating many JDBC calls as it does so.
   This section highlights the JDBC calls that make this specifically a
   client/server Derby application.
   The "<a href="embedded_intro.html#em_lookat_code">Embedded Derby</a>"
   section shows how to turn the same code into an embedded application.
   </p>
<a name="N1016D"></a><a name="jdbc_ns_client"></a>
<h4>Load the Client JDBC Driver</h4>
<p>
   When executed with the <span class="codefrag">derbyclient</span> argument,
   the <span class="codefrag">SimpleApp</span> application
   loads the Derby Network Client driver with this code:
   </p>
<p class="code-block">driver = "org.apache.derby.jdbc.ClientDriver";
...
Class.forName(driver).newInstance();
</p>
<a name="N10181"></a><a name="url_ns_client"></a>
<h4>Get a Network Server Connection</h4>
<p>
   When executed with the <span class="codefrag">derbyclient</span> argument,
   the <span class="codefrag">SimpleApp</span> application
   creates and connects to the <span class="codefrag">derbyDB</span> database with this code:
   </p>
<p class="code-block">protocol = "jdbc:derby://localhost:1527/";
...
conn = DriverManager.getConnection(protocol + "derbyDB;create=true", props);
</p>
<p>
   That connection URL, fully constructed, looks like this:
   </p>
<p class="code-block">jdbc:derby://localhost:1527/derbyDB;create=true</p>
<a name="N1019F"></a><a name="ns_client_noshutdown"></a>
<h4>Don't shut Derby down</h4>
<p>
   If you look at the <span class="codefrag">SimpleApp.java</span> code you'll notice that it
   only shuts Derby down if it's running in embedded mode.
   When connecting <em>via</em> the Network Server, 
   other applications might be accessing
   the same database you are; so, don't shut down the databases or Derby.
   </p>
<a name="N101B0"></a><a name="compile_ns_client"></a>
<h3 class="boxed">Compile Sample Application</h3>
<p>
   Compile the sample application as shown below:
   </p>
<p class="code-block">javac SimpleApp.java</p>
<a name="N101BE"></a><a name="run_ns_client"></a>
<h3 class="boxed">Run Sample Application</h3>
<p>
   Run the sample application like this:
   </p>
<p class="code-block">java SimpleApp derbyclient</p>
<p>You should see the output shown below:</p>
<p class="code-block">SimpleApp starting in derbyclient mode.
Loaded the appropriate driver.
Connected to and created database derbyDB
Created table derbyDB
Inserted 1956 Webster
Inserted 1910 Union
Updated 1956 Webster to 180 Grand
Updated 180 Grand to 300 Lakeshore
Verified the rows
Dropped table derbyDB
Closed result set and statement
Committed transaction and closed connection
SimpleApp finished</p>
<p>Quick question: 
      Where is the physical location of the <span class="codefrag">derbyDB</span> database 
      that the sample application creates?
   </p>
<p>
<em>(Answer: In the default
   <span class="codefrag">$DERBY_INSTALL/bin</span> location.)
   </em>
   
</p>
</div>


<a name="N101E2"></a><a name="stop_ns"></a>
<h2 class="boxed">Stop Network Server</h2>
<div class="section">
<p>
Stop the Network server by executing the
<span class="codefrag">stopNetworkServer.bat</span> (Windows) or
<span class="codefrag">stopNetworkServer.ksh</span> (UNIX) script, as shown below:
</p>
<p class="code-block">Windows:
C:\&gt; cd %DERBY_INSTALL%\bin
C:\Apache\db-derby-10.4.1.3-bin\bin&gt; setNetworkServerCP.bat
C:\Apache\db-derby-10.4.1.3-bin\bin&gt; stopNetworkServer.bat
</p>
<p class="code-block">UNIX:
$ cd $DERBY_INSTALL/bin
$ . setNetworkServerCP.ksh
$ stopNetworkServer.ksh
</p>
<p>The window running the NetworkServer should output a
message confirming the shutdown.
</p>
<p>Note that, as with <a href="#start_ns">starting the server</a>, there is
also an easier way to shut down the server. For example:
</p>
<p class="code-block">Windows:
C:\&gt; java -jar %DERBY_INSTALL%\lib\derbyrun.jar server shutdown
</p>
<p class="code-block">UNIX:
$ java -jar $DERBY_INSTALL/lib/derbyrun.jar server shutdown
</p>
<p>Run derbyrun.jar without arguments for further usage information.
derbyrun.jar has been included with Derby releases since the 10.2 release 
series.
</p>
</div>


<a name="N1020F"></a><a name="ns_next_steps"></a>
<h2 class="boxed">Next Steps</h2>
<div class="section">
<a name="N10215"></a><a name="Network+Server+Options"></a>
<h3 class="boxed">Network Server Options</h3>
<p>
By default, the Derby Network Server only accepts requests from the
localhost on port 1527.
You can modify the Network Server to:
</p>
<ul>
  
<li>
<a href="http://db.apache.org/derby/docs/dev/adminguide/tadminappssettingportnumbers.html">Listen on a port other than the default</a>.</li>
  
<li>
<a href="http://db.apache.org/derby/docs/dev/adminguide/cadminnetservsecurity.html">Accept requests from outside the localhost.</a>
</li>
  
<li>
<a href="http://db.apache.org/derby/docs/dev/adminguide/tadminnetservrun.html">Run in the Java 2 Security Manager</a> for increased security, 
      which we strongly recommend.
  </li>

</ul>
<p>
For more information about these options, and more, see the
<a href="http://db.apache.org/derby/manuals">Derby Server and 
Administration Guide</a>.
</p>
<a name="N1023A"></a><a name="Embedded+Server"></a>
<h3 class="boxed">Embedded Server</h3>
<p>
Up until this point,
this section has focused on how to start and stop
the Network Server as an independent process.
</p>
<p>
Another option, called the "embedded server",
allows an application to load the embedded JDBC driver for its own use and
start the Network Server to allow remote access by applications running
in other JVMs.
The application that does this can access the database with either the
embedded driver or the client driver.
</p>
<p>
Figure 3 depicts an application called
<span class="codefrag">MyEmbedSrvApp</span> that loads the embedded driver and also
starts up the Network Server.
This allows other applications,
such as <span class="codefrag">ij</span>
or <span class="codefrag">SimpleApp</span> using the Derby Network Client,
to connect to the same database <em>via</em> a client JDBC driver.
</p>
<p>

<strong>Figure 3: Derby Embedded Server Architecture</strong>

</p>
<p>

<img alt="Figure 3: Derby Embedded Server Architecture" src="embedded_server.png">
</p>
<p>
While it is certainly <em>possible</em> 
for <span class="codefrag">MyEmbedSrvApp</span> 
to use the Derby Network Client JDBC driver, 
it's probably better for it to use the embedded driver
because Derby Network Client JDBC database requests incur the
overhead of going out through the network.
The embedded server architecture lets
the application that embeds Derby retain the advantages of
embedded access while
also enabling remote access to the same database using another tool,
such as <span class="codefrag">ij</span>.
Thus, you end up with the best of both worlds: embedded and client/server.
</p>
<p>
You've reached the end of this Derby tutorial and should now understand
how to use Derby in the embedded and Network Server frameworks.
The "<a href="index.html#next">Overview</a>" section provides suggestions
for how you might use Derby with some other products.
</p>
</div>



</div>
<!--+
    |end content
    +-->
<div class="clearboth">&nbsp;</div>
</div>
<div id="footer">
<!--+
    |start bottomstrip
    +-->
<div class="lastmodified">
<script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
</div>
<div class="copyright">
        Copyright &copy;
         2004-2014 Apache, Apache DB, Apache Derby, Apache Torque, Apache JDO, Apache DDLUtils, the Derby hat logo, the Apache JDO logo, and the Apache feather logo are trademarks of The Apache Software Foundation. All other marks mentioned may be trademarks or registered trademarks of their respective owners.</div>
<div id="feedback">
    Send feedback about the website to:
  <a id="feedbackto" href="mailto:derby-user@db.apache.org?subject=Feedback%C2%A0papers/DerbyTut/ns_intro.html">derby-user@db.apache.org</a>
</div>
<!--+
    |end bottomstrip
    +-->
</div>
</body>
</html>
